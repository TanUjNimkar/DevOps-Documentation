SonarQube basics (read once, remember forever)

Java required: Java 17 (mandatory)

Runs as: non-root user (sonar)

Default port: 9000

Service: should run via systemd (NOT sonar.sh start in real setups)

Prod DB: PostgreSQL
(H2 is only for learning / demo)



1️⃣ SonarQube on Ubuntu 22.04

install_sonarqube_ubuntu.sh

#!/bin/bash
set -e

SONAR_VERSION=9.9.2.77730

echo "Updating system"
sudo apt update -y

echo "Installing Java 17"
sudo apt install -y openjdk-17-jdk unzip wget

echo "Creating sonar user"
sudo useradd -r -s /bin/false sonar || true

echo "Downloading SonarQube"
cd /opt
sudo wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-${SONAR_VERSION}.zip
sudo unzip sonarqube-${SONAR_VERSION}.zip
sudo mv sonarqube-${SONAR_VERSION} sonarqube

echo "Setting permissions"
sudo chown -R sonar:sonar /opt/sonarqube

echo "Configuring system limits"
sudo tee /etc/sysctl.d/99-sonarqube.conf <<EOF
vm.max_map_count=524288
fs.file-max=131072
EOF

sudo sysctl --system

echo "Creating systemd service"
sudo tee /etc/systemd/system/sonarqube.service <<EOF
[Unit]
Description=SonarQube service
After=network.target

[Service]
Type=forking
ExecStart=/opt/sonarqube/bin/linux-x86-64/sonar.sh start
ExecStop=/opt/sonarqube/bin/linux-x86-64/sonar.sh stop
User=sonar
Group=sonar
Restart=always
LimitNOFILE=131072
LimitNPROC=8192

[Install]
WantedBy=multi-user.target
EOF

echo "Starting SonarQube"
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable sonarqube
sudo systemctl start sonarqube

echo "SonarQube running on port 9000"

http://<server-ip>:9000
default login → admin / admin



---


SonarQube on Amazon Linux 2

install_sonarqube_amazonlinux.sh

#!/bin/bash
set -e

echo "Updating system"
sudo dnf update -y

echo "Installing Java 17, unzip, wget"
sudo dnf install -y java-17-amazon-corretto unzip wget

echo "Setting kernel params"
sudo tee /etc/sysctl.d/99-sonarqube.conf <<EOF
vm.max_map_count=262144
fs.file-max=65536
EOF
sudo sysctl --system

echo "Creating sonar user"
sudo useradd sonar || true

cd /opt

if [ ! -f sonarqube.zip ]; then
  sudo wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-9.9.3.79811.zip -O sonarqube.zip
fi

sudo rm -rf sonarqube sonarqube-*
sudo unzip sonarqube.zip
sudo mv sonarqube-* sonarqube

sudo chown -R sonar:sonar /opt/sonarqube

echo "SonarQube installed successfully"

sudo su - sonar
/opt/sonarqube/bin/linux-x86-64/sonar.sh start

/opt/sonarqube/bin/linux-x86-64/sonar.sh status


sudo su - sonar
/opt/sonarqube/bin/linux-x86-64/sonar.sh start
